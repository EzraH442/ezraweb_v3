---
title: "Logs of a weekend warrior sysadmin - SSH key accident"
date: "2023-08-10"
headline: "How I accidentally deleted all my SSH keys...and regained access to my servers"
---

## How I accidentally deleted all my SSH keys, and also 80% of my home directory

There I was, Wednesday after work, downlading a fresh zip file of a portable install of some note taking software I would use for univeristy. Foolishly, I had hastily downloaded it to my home directory, and even worse, unzipped it from the command line without specifying an output directory. I quickly realized my mistake, and stopped the unzip, but the few seconds it had been unzipping for made a real mess of my home directory. _No problem_, I thought. _No need to manually delete all these directories_, I thought. _I'll just find a command to delete the files in my home directory newer than X minutes old_, I thought.

Then, I ran (something similar to) `find . -mmin +5 -exec rm {} \;`

Fuuuuuuuuuuuuuck.

In my absolute genius, I had accidentally run a command that would delete all files in my home directory older than (not newer than!!!) 5 minutes old. I don't know how my brain mixed up greater than and less than while reading the man page, which states:

```
   TESTS
       Some tests, for example -newerXY and -samefile, allow comparison between the file currently being examined and some reference file speci‐
       fied on the command line.  When these tests are used, the interpretation of the reference file is determined by the options -H, -L and -P
       and any previous -follow, but the reference file is only examined once, at the time the command line is parsed.  If  the  reference  file
       cannot be examined (for example, the stat(2) system call fails for it), an error message is issued, and find exits with a nonzero status.

       A numeric argument n can be specified to tests (like -amin, -mtime, -gid, -inum, -links, -size, -uid and -used) as

       +n     for greater than n,

       -n     for less than n,

       n      for exactly n.
```

Suddenly, I saw swaths of files in the `.cache` folder being deleted, and I knew something was wrong and stopped the command. I ran `ls` in my home directory, and realized only a few directores were spared: `/Projects, /cs-club, /miniconda3, /picoctf, /tf-provider, /.dbus, /.android, /.ipython, /.yarn, and /.vscode-server`

Immediately, I realied that all my custom configuration for `fish` console and `neovim` were gone. Annoying, but would only take a day or so to fix since I don't stray too far from the defaults. It was only until a couple hours later when reality set in. When I tried to ssh into my personal website server, I realized I had also deleted my `/.ssh` and `/.gnupg` directories. Gulp. I was locked out of 3 servers (hosted on Oracle Cloud's amazing free tier): a mincraft server, my personal website server, and a vpn server. Of the three, I cared least about the minecraft server, so I was willing to test with it.

I tried 3 recovery options in descending order of jankiness. First up was attempting to use the built-in Oracle virtual cloud shell to login.

## Attempt 1 - OCI cloud shell login

I tried to launch a virtual cloud shell connection. When prompted for the username, I used the default user (ubuntu) and was prompted for the password. Since I had not set a password, this failed.

Next up would be to try the OCI local console connection that would (hopefully) allow me to create a temporary SSH tunnel to my server.

## Attempt 2 - OCI local console connection

After skimming the Oracle's documentation, the plan was to launch a serial connection then do some stuff with vcn (whatever that was) until I could change the ~/.ssh/authorized_keys file.

First, I (following the documentation) created a new 2048 bit rsa ssh key with `ssh-keygen -t rsa -b 2048`. I was, and still am, curious as to why they do not support newer key types such as ed-25519.

I then copy and pasted the command to connect generated by Oracle Cloud...

```
ssh -o ProxyCommand='ssh -W %h:%p -p 443 ocid1.instanceconsoleconnection.oc1.ca-montreal-1.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx@instance-console.ca-montreal-1.oci.oraclecloud.com' ocid1.instance.oc1.ca-montreal-1.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

...and was immediately hit with an error message:

```
Unable to negotiate with xxx.xxx.xx.xx port 443: no matching host key type found. Their offer: ssh-rsa
kex_exchange_identification: Connection closed by remote host
Connection closed by UNKNOWN port 65535
```

I ran with -v to get more info...

```
ssh -v -o ProxyCommand='ssh -v -W %h:%p -p 443 ocid1.instanceconsoleconnection.oc1.ca-montreal-1.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx@instance-console.ca-montreal-1.oci.oraclecloud.com' ocid1.instance.oc1.ca-montreal-1.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

...and got the output¹:

```
OpenSSH_8.9p1 Ubuntu-3ubuntu0.1, OpenSSL 3.0.2 15 Mar 2022
debug1: Reading configuration data /etc/ssh/ssh_config
debug1: /etc/ssh/ssh_config line 19: include /etc/ssh/ssh_config.d/*.conf matched no files
debug1: /etc/ssh/ssh_config line 21: Applying options for *
debug1: Executing proxy command: exec ssh -v -W ocid1.instance.oc1.ca-montreal-1.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx:22 -p 443 ocid1.instanceconsoleconnection.oc1.ca-montreal-1.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx@instance-console.ca-montreal-1.oci.oraclecloud.com
debug1: identity file /home/ezrahuang/.ssh/id_rsa type 0
debug1: identity file /home/ezrahuang/.ssh/id_rsa-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_ecdsa type -1
debug1: identity file /home/ezrahuang/.ssh/id_ecdsa-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_ecdsa_sk type -1
debug1: identity file /home/ezrahuang/.ssh/id_ecdsa_sk-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_ed25519 type -1
debug1: identity file /home/ezrahuang/.ssh/id_ed25519-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_ed25519_sk type -1
debug1: identity file /home/ezrahuang/.ssh/id_ed25519_sk-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_xmss type -1
debug1: identity file /home/ezrahuang/.ssh/id_xmss-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_dsa type -1
debug1: identity file /home/ezrahuang/.ssh/id_dsa-cert type -1
debug1: Local version string SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.1
OpenSSH_8.9p1 Ubuntu-3ubuntu0.1, OpenSSL 3.0.2 15 Mar 2022
debug1: Reading configuration data /etc/ssh/ssh_config
debug1: /etc/ssh/ssh_config line 19: include /etc/ssh/ssh_config.d/*.conf matched no files
debug1: /etc/ssh/ssh_config line 21: Applying options for *
debug1: Connecting to instance-console.ca-montreal-1.oci.oraclecloud.com [xxx.xxx.xx.xx] port 443.
debug1: Connection established.
debug1: identity file /home/ezrahuang/.ssh/id_rsa type 0
debug1: identity file /home/ezrahuang/.ssh/id_rsa-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_ecdsa type -1
debug1: identity file /home/ezrahuang/.ssh/id_ecdsa-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_ecdsa_sk type -1
debug1: identity file /home/ezrahuang/.ssh/id_ecdsa_sk-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_ed25519 type -1
debug1: identity file /home/ezrahuang/.ssh/id_ed25519-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_ed25519_sk type -1
debug1: identity file /home/ezrahuang/.ssh/id_ed25519_sk-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_xmss type -1
debug1: identity file /home/ezrahuang/.ssh/id_xmss-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_dsa type -1
debug1: identity file /home/ezrahuang/.ssh/id_dsa-cert type -1
debug1: Local version string SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.1
debug1: Remote protocol version 2.0, remote software version SerialService
debug1: compat_banner: no match: SerialService
debug1: Authenticating to instance-console.ca-montreal-1.oci.oraclecloud.com:443 as 'ocid1.instanceconsoleconnection.oc1.ca-montreal-1.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'
debug1: load_hostkeys: fopen /home/ezrahuang/.ssh/known_hosts2: No such file or directory
debug1: load_hostkeys: fopen /etc/ssh/ssh_known_hosts: No such file or directory
debug1: load_hostkeys: fopen /etc/ssh/ssh_known_hosts2: No such file or directory
debug1: SSH2_MSG_KEXINIT sent
debug1: SSH2_MSG_KEXINIT received
debug1: kex: algorithm: curve25519-sha256@libssh.org
debug1: kex: host key algorithm: (no match)
Unable to negotiate with xxx.xxx.xx.xx port 443: no matching host key type found. Their offer: ssh-rsa
kex_exchange_identification: Connection closed by remote host
Connection closed by UNKNOWN port 65535
(base) ezrahuang@LAPTOP-NJNSCTAV:~$ ssh -v -o ProxyCommand='ssh -v -W %h:%p -p 443 ocid1.instanceconsoleconnection.oc1.ca-montreal-1.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx@instance-console.ca-montreal-1.oci.oraclecloud.com' ocid1.instance.oc1.ca-montreal-1.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
OpenSSH_8.9p1 Ubuntu-3ubuntu0.1, OpenSSL 3.0.2 15 Mar 2022
debug1: Reading configuration data /etc/ssh/ssh_config
debug1: /etc/ssh/ssh_config line 19: include /etc/ssh/ssh_config.d/*.conf matched no files
debug1: /etc/ssh/ssh_config line 21: Applying options for *
debug1: Executing proxy command: exec ssh -v -W ocid1.instance.oc1.ca-montreal-1.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx:22 -p 443 ocid1.instanceconsoleconnection.oc1.ca-montreal-1.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx@instance-console.ca-montreal-1.oci.oraclecloud.com
debug1: identity file /home/ezrahuang/.ssh/id_rsa type 0
debug1: identity file /home/ezrahuang/.ssh/id_rsa-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_ecdsa type -1
debug1: identity file /home/ezrahuang/.ssh/id_ecdsa-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_ecdsa_sk type -1
debug1: identity file /home/ezrahuang/.ssh/id_ecdsa_sk-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_ed25519 type -1
debug1: identity file /home/ezrahuang/.ssh/id_ed25519-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_ed25519_sk type -1
debug1: identity file /home/ezrahuang/.ssh/id_ed25519_sk-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_xmss type -1
debug1: identity file /home/ezrahuang/.ssh/id_xmss-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_dsa type -1
debug1: identity file /home/ezrahuang/.ssh/id_dsa-cert type -1
debug1: Local version string SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.1
OpenSSH_8.9p1 Ubuntu-3ubuntu0.1, OpenSSL 3.0.2 15 Mar 2022
debug1: Reading configuration data /etc/ssh/ssh_config
debug1: /etc/ssh/ssh_config line 19: include /etc/ssh/ssh_config.d/*.conf matched no files
debug1: /etc/ssh/ssh_config line 21: Applying options for *
debug1: Connecting to instance-console.ca-montreal-1.oci.oraclecloud.com [xxx.xxx.xx.xx] port 443.
debug1: Connection established.
debug1: identity file /home/ezrahuang/.ssh/id_rsa type 0
debug1: identity file /home/ezrahuang/.ssh/id_rsa-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_ecdsa type -1
debug1: identity file /home/ezrahuang/.ssh/id_ecdsa-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_ecdsa_sk type -1
debug1: identity file /home/ezrahuang/.ssh/id_ecdsa_sk-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_ed25519 type -1
debug1: identity file /home/ezrahuang/.ssh/id_ed25519-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_ed25519_sk type -1
debug1: identity file /home/ezrahuang/.ssh/id_ed25519_sk-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_xmss type -1
debug1: identity file /home/ezrahuang/.ssh/id_xmss-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_dsa type -1
debug1: identity file /home/ezrahuang/.ssh/id_dsa-cert type -1
debug1: Local version string SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.1
debug1: Remote protocol version 2.0, remote software version SerialService
debug1: compat_banner: no match: SerialService
debug1: Authenticating to instance-console.ca-montreal-1.oci.oraclecloud.com:443 as 'ocid1.instanceconsoleconnection.oc1.ca-montreal-1.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'
debug1: load_hostkeys: fopen /home/ezrahuang/.ssh/known_hosts2: No such file or directory
debug1: load_hostkeys: fopen /etc/ssh/ssh_known_hosts: No such file or directory
debug1: load_hostkeys: fopen /etc/ssh/ssh_known_hosts2: No such file or directory
debug1: SSH2_MSG_KEXINIT sent
debug1: SSH2_MSG_KEXINIT received
debug1: kex: algorithm: curve25519-sha256@libssh.org
debug1: kex: host key algorithm: (no match)
Unable to negotiate with xxx.xxx.xx.xx port 443: no matching host key type found. Their offer: ssh-rsa
kex_exchange_identification: Connection closed by remote host
Connection closed by UNKNOWN port 65535
```

Hmm.

I did some searching and stumbled across [this page for legacy OpenSSH troubleshooting](http://www.openssh.com/legacy.html) and it seemed like the issue was that the ssh-rsa key type was being used on Oracle's end but not used on my end. I decided to try adding the ssh-rsa key type to HostKeyAlgorithms and also cleaning up the command by adding an entry into my ssh config file.

```apacheconf
Host test
    User ocid1.instanceconsoleconnection.oc1.ca-montreal-1.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    Hostname instance-console.ca-montreal-1.oci.oraclecloud.com
    HostKeyAlgorithms ssh-rsa
```

I then ran...

```
ssh -v -o ProxyCommand='ssh -vvv -W %h:%p -p 443 test' ocid1.instance.oc1.ca-montreal-1.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

...and got new output:

```
OpenSSH*8.9p1 Ubuntu-3ubuntu0.1, OpenSSL 3.0.2 15 Mar 2022
debug1: Reading configuration data /home/ezrahuang/.ssh/config
debug1: Reading configuration data /etc/ssh/ssh_config
debug1: /etc/ssh/ssh_config line 19: include /etc/ssh/ssh_config.d/*.conf matched no files
debug1: /etc/ssh/ssh*config line 21: Applying options for *
debug1: Executing proxy command: exec ssh -v -W ocid1.instance.oc1.ca-montreal-1.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx:22 -p 443 test
debug1: identity file /home/ezrahuang/.ssh/id*rsa type 0
debug1: identity file /home/ezrahuang/.ssh/id_rsa-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_ecdsa type -1
debug1: identity file /home/ezrahuang/.ssh/id_ecdsa-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_ecdsa_sk type -1
debug1: identity file /home/ezrahuang/.ssh/id_ecdsa_sk-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_ed25519 type 3
debug1: identity file /home/ezrahuang/.ssh/id_ed25519-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_ed25519_sk type -1
debug1: identity file /home/ezrahuang/.ssh/id_ed25519_sk-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_xmss type -1
debug1: identity file /home/ezrahuang/.ssh/id_xmss-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_dsa type -1
debug1: identity file /home/ezrahuang/.ssh/id_dsa-cert type -1
debug1: Local version string SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.1
OpenSSH_8.9p1 Ubuntu-3ubuntu0.1, OpenSSL 3.0.2 15 Mar 2022
debug1: Reading configuration data /home/ezrahuang/.ssh/config
debug1: /home/ezrahuang/.ssh/config line 1: Applying options for mc
debug1: Reading configuration data /etc/ssh/ssh_config
debug1: /etc/ssh/ssh_config line 19: include /etc/ssh/ssh_config.d/*.conf matched no files
debug1: /etc/ssh/ssh*config line 21: Applying options for *
debug1: Connecting to instance-console.ca-montreal-1.oci.oraclecloud.com [xxx.xxx.xx.xx] port 443.
debug1: Connection established.
debug1: identity file /home/ezrahuang/.ssh/id_rsa type 0
debug1: identity file /home/ezrahuang/.ssh/id_rsa-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_ecdsa type -1
debug1: identity file /home/ezrahuang/.ssh/id_ecdsa-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_ecdsa_sk type -1
debug1: identity file /home/ezrahuang/.ssh/id_ecdsa_sk-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_ed25519 type 3
debug1: identity file /home/ezrahuang/.ssh/id_ed25519-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_ed25519_sk type -1
debug1: identity file /home/ezrahuang/.ssh/id_ed25519_sk-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_xmss type -1
debug1: identity file /home/ezrahuang/.ssh/id_xmss-cert type -1
debug1: identity file /home/ezrahuang/.ssh/id_dsa type -1
debug1: identity file /home/ezrahuang/.ssh/id_dsa-cert type -1
debug1: Local version string SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.1
debug1: Remote protocol version 2.0, remote software version SerialService
debug1: compat_banner: no match: SerialService
debug1: Authenticating to instance-console.ca-montreal-1.oci.oraclecloud.com:443 as 'ocid1.instanceconsoleconnection.oc1.ca-montreal-1.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'
debug1: load_hostkeys: fopen /etc/ssh/ssh_known_hosts: No such file or directory
debug1: load_hostkeys: fopen /etc/ssh/ssh_known_hosts2: No such file or directory
debug1: SSH2_MSG_KEXINIT sent
debug1: SSH2_MSG_KEXINIT received
debug1: kex: algorithm: curve25519-sha256@libssh.org
debug1: kex: host key algorithm: ssh-rsa
debug1: kex: server->client cipher: aes128-ctr MAC: hmac-sha2-256-etm@openssh.com compression: none
debug1: kex: client->server cipher: aes128-ctr MAC: hmac-sha2-256-etm@openssh.com compression: none
debug1: expecting SSH2_MSG_KEX_ECDH_REPLY
debug1: SSH2_MSG_KEX_ECDH_REPLY received
debug1: Server host key: ssh-rsa SHA256:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
debug1: load_hostkeys: fopen /etc/ssh/ssh_known_hosts: No such file or directory
debug1: load_hostkeys: fopen /etc/ssh/ssh_known_hosts2: No such file or directory
debug1: Host '[instance-console.ca-montreal-1.oci.oraclecloud.com]:443' is known and matches the RSA host key.
debug1: Found key in /home/ezrahuang/.ssh/known_hosts:4
debug1: rekey out after 4294967296 blocks
debug1: SSH2_MSG_NEWKEYS sent
debug1: expecting SSH2_MSG_NEWKEYS
debug1: SSH2_MSG_NEWKEYS received
debug1: rekey in after 4294967296 blocks
debug1: Will attempt key: /home/ezrahuang/.ssh/id_rsa RSA SHA256:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
debug1: Will attempt key: /home/ezrahuang/.ssh/id_ecdsa
debug1: Will attempt key: /home/ezrahuang/.ssh/id_ecdsa_sk
debug1: Will attempt key: /home/ezrahuang/.ssh/id_ed25519 ED25519 SHA256:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
debug1: Will attempt key: /home/ezrahuang/.ssh/id_ed25519_sk
debug1: Will attempt key: /home/ezrahuang/.ssh/id_xmss
debug1: Will attempt key: /home/ezrahuang/.ssh/id_dsa
debug1: SSH2_MSG_SERVICE_ACCEPT received

=================================================
IMPORTANT: Use a console connection to troubleshoot a malfunctioning instance. For normal operations, you should connect to the instance using a Secure Shell (SSH) or Remote Desktop connection. For steps, see https://docs.cloud.oracle.com/iaas/Content/Compute/Tasks/accessinginstance.htm

# For more information about troubleshooting your instance using a console connection, see the documentation: https://docs.cloud.oracle.com/en-us/iaas/Content/Compute/References/serialconsole.htm#four

debug1: Authentications that can continue: publickey
debug1: Next authentication method: publickey
debug1: Offering public key: /home/ezrahuang/.ssh/id_rsa RSA SHA256:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
debug1: send_pubkey_test: no mutual signature algorithm
debug1: Trying private key: /home/ezrahuang/.ssh/id_ecdsa
debug1: Trying private key: /home/ezrahuang/.ssh/id_ecdsa_sk
debug1: Offering public key: /home/ezrahuang/.ssh/id_ed25519 ED25519 SHA256:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
debug1: Authentications that can continue: publickey
debug1: Trying private key: /home/ezrahuang/.ssh/id_ed25519_sk
debug1: Trying private key: /home/ezrahuang/.ssh/id_xmss
debug1: Trying private key: /home/ezrahuang/.ssh/id_dsa
debug1: No more authentication methods to try.
ocid1.instanceconsoleconnection.oc1.ca-montreal-1.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx@instance-console.ca-montreal-1.oci.oraclecloud.com: Permission denied (publickey).
kex_exchange_identification: Connection closed by remote host
Connection closed by UNKNOWN port 65535
```

I did a bit more fiddling around (tried exact same process with higher bit count (4096) and more modern rsa but was never accepted) and it seemed impossible to get any further than this.

I gave up and decided to try another way, and come back to this one if the other one didn't work.

### Attempt 3 - mount boot volume to new instance

After skimming Oracle's documentation on boot volumes, I came up with a plan. Since I was at the max free tier resources, I first needed to resize the minecraft server to have n-1 vCPUs and n-1 memory so that I could create a new instance I could login to. After this, the plan would be to:

1. create a new instance (A) that I can login to
2. Stop the instance (B) that I can't login to
3. Detach B's boot volume from B
4. Mount B's boot volume to A
5. While in A, find B's `authorized_keys` file and add my new key
6. Unmount B's boot volume from A and re-attach it to B
7. Start B and (hopefully) ssh into it

Luckily, I found a couple tutorials with the exact same steps (from people who had f$$$$$ themselves in the same way I had), and (roughly) followed the steps [here (javascript blocking on site recomended)](http://himanshusinhadba.blogspot.com/2019/03/recovering-opc-user-ssh-key-oci.html). This went smoothly and I was able to sucessfully recover access to to the minecraft server, then my website server, then my vpn server.

## final thoughts

1. run ls before rm when doing mass file deletions
2. backup important credentials
3. I wonder why oracle only supports outdated key types for local console connections

Notes:

- [1] Shrewd readers may notice that I am using an ubuntu system, not debian with awesomewm like I had previously claimed. This is because I have purchased a new laptop and now have a Windows + WSL2 setup due to anticipated issues with university and/or work-related Windows-only software. Hardware limitations (low disk space) prevent me from being able to run a practical dual-boot setup, and development on Windows is a pain, so this is the best option for me.
